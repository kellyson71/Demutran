<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta
      charset="UTF-8"
      name="viewport"
      content="width=device-width, initial-scale=1.0" />

    <title>Solicitação DEMUTRAN</title>
    <!-- Inclua o Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inclua o Bootstrap para modais, se necessário -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet" />
    <!-- Inclua o Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="icon" href="../icon.png" type="image/png" />
    <style>
        .required-field::after {
            content: '*';
            color: #ef4444;
            margin-left: 4px;
        }
    </style>
  </head>
  <body class="min-h-screen bg-gray-100">
    <!-- Topbar -->
    <header
      class="bg-green-600 text-white shadow-md w-full fixed top-0 left-0 z-50">
      <div
        class="container mx-auto px-4 py-3 flex justify-between items-center">
        <!-- Logo -->
        <div class="text-lg font-semibold flex items-center">
          <img src="../assets/icon.png" alt="DEMUTRAN" class="h-8 w-8 mr-2" />
          <a href="../" class="hover:text-green-300">DEMUTRAN</a>
        </div>

        <!-- Links -->
        <nav class="hidden md:flex space-x-6">
          <a href="../PCD/index.html" class="hover:text-green-300"
            >Cartão Vaga Especial</a
          >
          <a href="../Defesa/index.html" class="hover:text-green-300"
            >Defesa Prévia/JARI</a
          >
          <a href="../DAT/index.php" class="hover:text-green-300">DAT</a>
          <a href="../Parecer/index.php" class="hover:text-green-300"
            >Parecer</a
          >
          <a href="../contato/index.html" class="hover:text-green-300"
            >Contato</a
          >
        </nav>

        <!-- Mobile menu button -->
        <div class="md:hidden">
          <button id="menu-btn" class="text-white focus:outline-none">
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
      </div>

      <!-- Mobile menu -->
      <div id="mobile-menu" class="hidden md:hidden bg-green-600">
        <a
          href="../PCD/index.html"
          class="block px-4 py-2 text-white hover:bg-green-500"
          >Cartão Vaga Especial</a
        >
        <a
          href="../Defesa/index.html"
          class="block px-4 py-2 text-white hover:bg-green-500"
          >Defesa Prévia/JARI</a
        >
        <a
          href="../DAT/index.php"
          class="block px-4 py-2 text-white hover:bg-green-500"
          >DAT</a
        >
        <a
          href="../Parecer/index.php"
          class="block px-4 px-2 text-white hover:bg-green-500"
          >Parecer</a
        >
        <a
          href="../contato/index.html"
          class="block px-4 py-2 text-white hover:bg-green-500"
          >Contato</a
        >
      </div>
    </header>

    <!-- Conteúdo Principal -->
    <div class="pt-24 flex justify-center">
      <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-4xl">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">
          <i class="far fa-edit"></i> Solicitação DEMUTRAN
        </h2>
        <div
          class="flex p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50"
          role="alert">
          <svg
            class="flex-shrink-0 inline w-4 h-4 me-3 mt-[2px]"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            viewBox="0 0 20 20">
            <path
              d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z" />
          </svg>
          <div>
            <span class="font-medium">Informações importantes:</span>
            <ul class="mt-1.5 list-disc list-inside">
              <li>Todos os documentos devem ser enviados em formato PDF</li>
              <li>
                Em caso de pessoa jurídica, anexar o ato constitutivo da empresa
              </li>
              <li>Para representação por terceiros, incluir procuração</li>
            </ul>
          </div>
        </div>
        <p class="text-gray-600 mb-6">
          <strong
            >Preencha todos os dados para podermos dar continuidade à sua
            solicitação.</strong
          >
        </p>
        <!-- <div id="documentosNecessarios" class="text-gray-600 mb-6">
          <strong>Documentos necessários:</strong>
          <ul class="list-disc list-inside mt-2">
            <li>
              Cópia da CNH ou outro documento de identificação do proprietário;
            </li>
            <li>
              Quando pessoa jurídica, anexar também o ato constitutivo da
              empresa;
            </li>
            <li>Em caso de representação por terceiros, incluir procuração.</li>
          </ul>
          <p class="mt-2 text-sm text-gray-500">
            Obs.: Todos os documentos devem estar em formato PDF.
          </p>
        </div> -->

        <!-- Progress Stepper -->
        <div class="mb-8">
          <ol class="flex items-center w-full mb-4 sm:mb-5">
            <li
              id="step1"
              class="flex w-full items-center text-green-600 after:content-[''] after:w-full after:h-1 after:border-b after:border-green-100 after:border-4 after:inline-block">
              <span
                class="flex items-center justify-center w-10 h-10 bg-green-100 rounded-full lg:h-12 lg:w-12 shrink-0">
                1
              </span>
            </li>
            <li
              id="step2"
              class="flex w-full items-center after:content-[''] after:w-full after:h-1 after:border-b after:border-gray-100 after:border-4 after:inline-block">
              <span
                class="flex items-center justify-center w-10 h-10 bg-gray-100 rounded-full lg:h-12 lg:w-12 shrink-0">
                2
              </span>
            </li>
            <li id="step3" class="flex items-center">
              <span
                class="flex items-center justify-center w-10 h-10 bg-gray-100 rounded-full lg:h-12 lg:w-12 shrink-0">
                3
              </span>
            </li>
          </ol>
          <div class="flex justify-between">
            <div class="text-center flex-1">
              <span class="text-green-600 font-medium" id="step1Text"
                >Preenchimento</span
              >
            </div>
            <div class="text-center flex-1">
              <span class="text-gray-500 font-medium" id="step2Text"
                >Imprimir/Assinar</span
              >
            </div>
            <div class="text-center flex-1">
              <span class="text-gray-500 font-medium" id="step3Text">Anexos</span>
            </div>
          </div>
        </div>
        <!-- Rest of the form content -->
        <form
          id="DefesaForm"
          method="post"
          enctype="multipart/form-data"
          target="_blank">
          <!-- Tipo da Solicitação -->
          <div class="mb-4">
            <label for="tipo_solicitacao" class="block text-gray-700 mb-2">
              <i class="fas fa-list"></i> Tipo da Solicitação:
            </label>
            <select
              id="tipo_solicitacao"
              name="tipo_solicitacao"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500">
              <option value="">Selecione o tipo de solicitação</option>
              <option value="defesa_previa">Defesa Prévia</option>
              <option value="apresentacao_condutor">
                Apresentação do Condutor
              </option>
              <option value="jari">JARI</option>
            </select>
          </div>

          <!-- Tipo de Requerente - NOVO CAMPO -->
          <div class="mb-4">
            <label class="block text-gray-700 mb-2">
              <i class="fas fa-user-tag"></i> Você é:
            </label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" id="proprietario" name="tipo_requerente" value="proprietario" required>
                <label for="proprietario">Proprietário</label>
              </div>
              <div class="radio-option">
                <input type="radio" id="condutor" name="tipo_requerente" value="condutor" required>
                <label for="condutor">Condutor</label>
              </div>
            </div>
          </div>

          <!-- Campos específicos para Apresentação do Condutor -->
          <div id="campos_apresentacao" class="hidden">
            <div class="mb-4">
              <label for="identidade" class="block text-gray-700 mb-2">
                <i class="fas fa-id-card"></i> Identidade:
              </label>
              <input
                type="text"
                id="identidade"
                name="identidade"
                class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
            </div>

            <div class="mb-4">
              <label for="orgao_emissor" class="block text-gray-700 mb-2">
                <i class="fas fa-building"></i> Órgão Emissor:
              </label>
              <input
                type="text"
                id="orgao_emissor"
                name="orgao_emissor"
                value="DEMUTRAN   21787-0"
                class="w-full border rounded-md p-2 bg-gray-100 text-gray-600"
                disabled />
            </div>
            <div class="mb-4">
                <label for="registro_cnh_infrator" class="block text-gray-700 mb-2">
                    <i class="fas fa-id-card"></i> Nº Registro CNH do Infrator:
                </label>
                <input
                    type="text"
                    id="registro_cnh_infrator"
                    name="registro_cnh_infrator"
                    placeholder="Exemplo: 12345678901"
                    class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
            </div>
            <!-- CNH do Condutor -->
            <div class="mb-4">
                <label for="cnh_numero" class="block text-gray-700 mb-2">
                    <i class="fas fa-id-card"></i> Número da CNH:
                </label>
                <input
                    type="text"
                    id="cnh_numero"
                    name="cnh_numero"
                    placeholder="Exemplo: 12345678901"
                    class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
            </div>

            <!-- UF da CNH -->
            <div class="mb-4">
                <label for="cnh_uf" class="block text-gray-700 mb-2">
                    <i class="fas fa-map-marker-alt"></i> UF da CNH:
                </label>
                <select
                    id="cnh_uf"
                    name="cnh_uf"
                    class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                    <option value="">Selecione a UF</option>
                    <option value="AC">AC</option>
                    <option value="AL">AL</option>
                    <option value="AP">AP</option>
                    <option value="AM">AM</option>
                    <option value="BA">BA</option>
                    <option value="CE">CE</option>
                    <option value="DF">DF</option>
                    <option value="ES">ES</option>
                    <option value="GO">GO</option>
                    <option value="MA">MA</option>
                    <option value="MT">MT</option>
                    <option value="MS">MS</option>
                    <option value="MG">MG</option>
                    <option value="PA">PA</option>
                    <option value="PB">PB</option>
                    <option value="PR">PR</option>
                    <option value="PE">PE</option>
                    <option value="PI">PI</option>
                    <option value="RJ">RJ</option>
                    <option value="RN">RN</option>
                    <option value="RS">RS</option>
                    <option value="RO">RO</option>
                    <option value="RR">RR</option>
                    <option value="SC">SC</option>
                    <option value="SP">SP</option>
                    <option value="SE">SE</option>
                    <option value="TO">TO</option>
                </select>
            </div>
          </div>

          <!-- Campos específicos para Defesa Prévia -->
          <div id="campos_defesa" class="hidden">
          </div>

          <!-- Nome -->
          <div class="mb-4">
            <label for="nome" class="block text-gray-700 mb-2">
              <i class="fas fa-user"></i> Seu nome:
            </label>
            <input
              type="text"
              id="nome"
              name="nome"
              required
              placeholder="Exemplo: João da Silva"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- CPF -->
          <div class="mb-4">
            <label for="cpf" class="block text-gray-700 mb-2">
              <i class="fas fa-id-card"></i> CPF:
            </label>
            <input
              type="text"
              id="cpf"
              name="cpf"
              required
              placeholder="Exemplo: 123.456.789-00"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Endereço -->
          <div class="mb-4">
            <label for="endereco" class="block text-gray-700 mb-2">
              <i class="fas fa-home"></i> Endereço:
            </label>
            <input
              type="text"
              id="endereco"
              name="endereco"
              placeholder="Exemplo: Rua das Flores"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Número -->
          <div class="mb-4">
            <label for="numero" class="block text-gray-700 mb-2">
              <i class="fas fa-hashtag"></i> Número:
            </label>
            <input
              type="text"
              id="numero"
              name="numero"
              placeholder="Exemplo: 123"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Complemento -->
          <div class="mb-4">
            <label for="complemento" class="block text-gray-700 mb-2">
              <i class="fas fa-building"></i> Complemento:
            </label>
            <input
              type="text"
              id="complemento"
              name="complemento"
              placeholder="Exemplo: Apto 101"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Bairro -->
          <div class="mb-4">
            <label for="bairro" class="block text-gray-700 mb-2">
              <i class="fas fa-map-marker-alt"></i> Bairro:
            </label>
            <input
              type="text"
              id="bairro"
              name="bairro"
              placeholder="Exemplo: Centro"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- CEP -->
          <div class="mb-4">
            <label for="cep" class="block text-gray-700 mb-2">
              <i class="fas fa-envelope"></i> CEP:
            </label>
            <input
              type="text"
              id="cep"
              name="cep"
              placeholder="Exemplo: 59900-000"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Município -->
          <div class="mb-4">
            <label for="municipio" class="block text-gray-700 mb-2">
              <i class="fas fa-city"></i> Município:
            </label>
            <input
              type="text"
              id="municipio"
              name="municipio"
              placeholder="Exemplo: Pau dos Ferros"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Telefone -->
          <div class="mb-4">
            <label for="telefone" class="block text-gray-700 mb-2">
              <i class="fas fa-phone"></i> Telefone Para Contato:
            </label>
            <input
              type="tel"
              id="telefone"
              name="telefone"
              placeholder="Exemplo: (84) 99999-9999"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Placa -->
          <div class="mb-4">
            <label for="placa" class="block text-gray-700 mb-2">
              <i class="fas fa-car"></i> Placa:
            </label>
            <input
              type="text"
              id="placa"
              name="placa"
              placeholder="Exemplo: ABC-1234"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Marca/Modelo -->
          <div class="mb-4">
            <label for="marcaModelo" class="block text-gray-700 mb-2">
              <i class="fas fa-car"></i> Marca/Modelo:
            </label>
            <input
              type="text"
              id="marcaModelo"
              name="marcaModelo"
              placeholder="Exemplo: Fiat Uno"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Cor -->
          <div class="mb-4">
            <label for="cor" class="block text-gray-700 mb-2">
              <i class="fas fa-palette"></i> Cor:
            </label>
            <input
              type="text"
              id="cor"
              name="cor"
              placeholder="Exemplo: Branco"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Espécie -->
          <div class="mb-4">
            <label for="especie" class="block text-gray-700 mb-2">
              <i class="fas fa-car-side"></i> Espécie:
            </label>
            <select
              id="especie"
              name="especie"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500">
              <option value="">Selecione a espécie do veículo</option>
              <optgroup label="De Passageiros">
                <option value="BICICLETA">Bicicleta</option>
                <option value="CICLOMOTOR">Ciclomotor</option>
                <option value="MOTONETA_PASSAGEIRO">Motoneta</option>
                <option value="MOTOCICLETA_PASSAGEIRO">Motocicleta</option>
                <option value="TRICICLO_PASSAGEIRO">Triciclo</option>
                <option value="QUADRICICLO_PASSAGEIRO">Quadriciclo</option>
                <option value="AUTOMOVEL">Automóvel</option>
                <option value="MICROONIBUS">Microônibus</option>
                <option value="ONIBUS">Ônibus</option>
                <option value="BONDE">Bonde</option>
                <option value="REBOQUE_PASSAGEIRO">Reboque/Semi-reboque</option>
                <option value="CHARRETE">Charrete</option>
              </optgroup>
              <optgroup label="De Carga">
                <option value="MOTONETA_CARGA">Motoneta</option>
                <option value="MOTOCICLETA_CARGA">Motocicleta</option>
                <option value="TRICICLO_CARGA">Triciclo</option>
                <option value="QUADRICICLO_CARGA">Quadriciclo</option>
                <option value="CAMINHONETE">Caminhonete</option>
                <option value="CAMINHAO">Caminhão</option>
                <option value="REBOQUE_CARGA">Reboque/Semi-reboque</option>
                <option value="CARROCA">Carroça</option>
                <option value="CARRO_MAO">Carro-de-mão</option>
              </optgroup>
              <optgroup label="Misto">
                <option value="CAMIONETA">Camioneta</option>
                <option value="UTILITARIO">Utilitário</option>
                <option value="OUTROS_MISTO">Outros</option>
              </optgroup>
              <option value="COMPETICAO">De Competição</option>
              <optgroup label="De Tração">
                <option value="CAMINHAO_TRATOR">Caminhão-trator</option>
                <option value="TRATOR_RODAS">Trator de rodas</option>
                <option value="TRATOR_ESTEIRAS">Trator de esteiras</option>
                <option value="TRATOR_MISTO">Trator misto</option>
              </optgroup>
              <optgroup label="Especial">
                <option value="MOTOCICLETA_ESPECIAL">Motocicleta</option>
                <option value="TRICICLO_ESPECIAL">Triciclo</option>
                <option value="AUTOMOVEL_ESPECIAL">Automóvel</option>
                <option value="MICROONIBUS_ESPECIAL">Micro-ônibus</option>
                <option value="ONIBUS_ESPECIAL">Ônibus</option>
                <option value="REBOQUE_ESPECIAL">Reboque/Semirreboque</option>
                <option value="CAMIONETA_ESPECIAL">Camioneta</option>
                <option value="CAMINHAO_ESPECIAL">Caminhão</option>
                <option value="CAMINHAO_TRATOR_ESPECIAL">Caminhão-trator</option>
                <option value="CAMINHONETE_ESPECIAL">Caminhonete</option>
                <option value="UTILITARIO_ESPECIAL">Utilitário</option>
                <option value="MOTOR_CASA">Motor-casa</option>
              </optgroup>
              <option value="COLECAO">De Coleção</option>
            </select>
          </div>

          <!-- Categoria -->
          <div class="mb-4">
            <label for="categoria" class="block text-gray-700 mb-2">
              <i class="fas fa-tags"></i> Categoria:
            </label>
            <select
              id="categoria"
              name="categoria"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500">
              <option value="">Selecione a categoria do veículo</option>
              <option value="OFICIAL">Oficial</option>
              <option value="DIPLOMATICO">Representação Diplomática/Consular</option>
              <option value="PARTICULAR">Particular</option>
              <option value="ALUGUEL">Aluguel</option>
              <option value="APRENDIZAGEM">Aprendizagem</option>
            </select>
          </div>

          <!-- Ano -->
          <div class="mb-4">
            <label for="ano" class="block text-gray-700 mb-2">
              <i class="fas fa-calendar-alt"></i> Ano:
            </label>
            <input
              type="text"
              id="ano"
              name="ano"
              placeholder="Exemplo: 2020"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Auto de Infração -->
          <div class="mb-4">
            <label for="autoInfracao" class="block text-gray-700 mb-2">
              <i class="fas fa-file-alt"></i> Auto de Infração nº:
            </label>
            <input
              type="text"
              id="autoInfracao"
              name="autoInfracao"
              placeholder="Exemplo: 123456789"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Data da Infração -->
          <div class="mb-4">
            <label for="dataInfracao" class="block text-gray-700 mb-2">
              <i class="fas fa-calendar-day"></i> Data da Infração:
            </label>
            <input
              type="date"
              id="dataInfracao"
              name="dataInfracao"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Hora da Infração -->
          <div class="mb-4">
            <label for="horaInfracao" class="block text-gray-700 mb-2">
              <i class="fas fa-clock"></i> Hora da Infração:
            </label>
            <input
              type="time"
              id="horaInfracao"
              name="horaInfracao"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Local da Infração -->
          <div class="mb-4">
            <label for="localInfracao" class="block text-gray-700 mb-2">
              <i class="fas fa-map-marker-alt"></i> Local da Infração:
            </label>
            <input
              type="text"
              id="localInfracao"
              name="localInfracao"
              placeholder="Exemplo: Av. Principal"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Enquadramento -->
          <div class="mb-4">
            <label for="enquadramento" class="block text-gray-700 mb-2">
              <i class="fas fa-gavel"></i> Enquadramento:
            </label>
            <input
              type="text"
              id="enquadramento"
              name="enquadramento"
              placeholder="Exemplo: Art. 203 V"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>

          <!-- Defesa -->
          <div class="mb-4">
            <label for="defesa" class="block text-gray-700 mb-2">
              <i class="fas fa-comment-alt"></i> Descreva sua Defesa:
            </label>
            <textarea
              id="defesa"
              name="defesa"
              rows="4"
              placeholder="Exemplo: Minha defesa é baseada em..."
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
          </div>

          <!-- Campo Gmail -->
          <div class="mb-4">
            <label for="gmail" class="block text-gray-700 mb-2">
              <i class="fas fa-envelope"></i> Email:
            </label>
            <input
              type="email"
              id="gmail"
              name="gmail"
              placeholder="Seu endereço Gmail"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500"
              required />
          </div>

          <!-- Campo Confirmar Gmail -->
          <div class="mb-4">
            <label for="confirm_gmail" class="block text-gray-700 mb-2">
              <i class="fas fa-envelope"></i> Confirme seu Email:
            </label>
            <input
              type="email"
              id="confirm_gmail"
              name="confirm_gmail"
              placeholder="Confirme seu endereço Gmail"
              class="w-full border rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500"
              required />
          </div>

          <div class="mb-4">
            <label for="declaracao" class="block text-gray-700 mb-2">
              <input type="checkbox" id="declaracao" name="declaracao" />
              Declaro que todas as informações fornecidas são verdadeiras.
            </label>
          </div>

          <button
            type="button"
            onclick="validateAndProceed()"
            class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
            Enviar
          </button>
        </form>
        <!-- Segunda aba -->
        <div id="secondTab" class="hidden">
          <!-- Header Section -->
          <div class="border-b pb-4 mb-6">
            <h2 class="text-2xl font-bold text-gray-800">
              <i class="fas fa-file-alt text-green-500 mr-2"></i>
              Imprimir e Assinar Documento
            </h2>
            <p class="text-gray-600 mt-2">
              Por favor, siga os passos abaixo para imprimir e assinar seu documento.
            </p>
          </div>

          <div class="bg-gray-50 p-4 rounded-lg mb-4">
            <h3 class="font-semibold text-gray-700 mb-3">
              Instruções:
            </h3>
            <ol class="list-decimal ml-4 text-gray-600 space-y-2">
              <li>Clique no botão abaixo para gerar o documento</li>
              <li>Imprima o documento gerado</li>
              <li>Assine o documento manualmente</li>
              <li>Depois de assinar, clique em "Próximo" para anexar os documentos</li>
            </ol>

            <div class="mt-6 flex justify-center">
              <button onclick="submitForm()" class="bg-green-500 text-white px-6 py-2 rounded-md hover:bg-green-600 transition-colors flex items-center">
                <i class="fas fa-print mr-2"></i>
                Gerar e Imprimir Documento
              </button>
            </div>
          </div>

          <div class="flex justify-between mt-6">
            <button type="button" onclick="showFirstTab()" class="bg-gray-500 text-white px-6 py-2 rounded-md hover:bg-gray-600 transition-colors">
              <i class="fas fa-arrow-left mr-2"></i>
              Voltar
            </button>
            <button type="button" onclick="showThirdTab()" class="bg-green-500 text-white px-6 py-2 rounded-md hover:bg-green-600 transition-colors">
              Próximo
              <i class="fas fa-arrow-right ml-2"></i>
            </button>
          </div>
        </div>

        <!-- Terceira aba (Anexos) -->
        <div id="thirdTab" class="hidden">
          <!-- Document Upload Section -->
          <div class="mb-4">
            <label for="doc_requerimento" class="block text-gray-700 mb-2">
              <i class="far fa-file-alt"></i> Requerimento da Defesa <span class="text-red-500">*</span>
            </label>
            <input
              type="file"
              id="doc_requerimento"
              name="doc_requerimento"
              accept=".pdf"
              class="w-full text-gray-600 border rounded-md file:border-0 file:border-r border-gray-300 file:bg-gray-50 file:mr-4 file:py-2 file:px-4 hover:file:bg-gray-100 file:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500" />
          </div>

          <div class="mb-4">
            <label for="cnh" class="block text-gray-700 mb-2">
              <i class="far fa-id-card"></i> Documento de Identificação (CNH, RG ou outro documento oficial com foto):
            </label>
            <input
              type="file"
              id="cnh"
              name="cnh"
              accept=".pdf"
              class="w-full text-gray-600 border rounded-md file:border-0 file:border-r border-gray-300 file:bg-gray-50 file:mr-4 file:py-2 file:px-4 hover:file:bg-gray-100 file:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500" />
          </div>

          <div class="mb-4">
            <label for="cnh_condutor" class="block text-gray-700 mb-2">
              <i class="far fa-id-card"></i> Documento de Identificação do Condutor:
            </label>
            <input
              type="file"
              id="cnh_condutor"
              name="cnh_condutor"
              accept=".pdf"
              class="w-full text-gray-600 border rounded-md file:border-0 file:border-r border-gray-300 file:bg-gray-50 file:mr-4 file:py-2 file:px-4 hover:file:bg-gray-100 file:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500" />
          </div>

          <div class="mb-4">
            <label for="notif_DEMUTRAN" class="block text-gray-700 mb-2">
              <i class="far fa-file-alt"></i> Notificação DEMUTRAN <span class="text-red-500">*</span>
            </label>
            <input
              type="file"
              id="notif_DEMUTRAN"
              name="notif_DEMUTRAN"
              accept=".pdf"
              class="w-full text-gray-600 border rounded-md file:border-0 file:border-r border-gray-300 file:bg-gray-50 file:mr-4 file:py-2 file:px-4 hover:file:bg-gray-100 file:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500" />
          </div>

          <div class="mb-4">
            <label for="crlv" class="block text-gray-700 mb-2">
              <i class="far fa-file-alt"></i> CRLV <span class="text-red-500">*</span>
            </label>
            <input
              type="file"
              id="crlv"
              name="crlv"
              accept=".pdf"
              class="w-full text-gray-600 border rounded-md file:border-0 file:border-r border-gray-300 file:bg-gray-50 file:mr-4 file:py-2 file:px-4 hover:file:bg-gray-100 file:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500" />
          </div>

          <div class="mb-4">
            <label
              for="comprovante_residencia"
              class="block text-gray-700 mb-2">
              <i class="far fa-file-alt"></i> Comprovante de Residência:
            </label>
            <input
              type="file"
              id="comprovante_residencia"
              name="comprovante_residencia"
              accept=".pdf"
              class="w-full text-gray-600 border rounded-md file:border-0 file:border-r border-gray-300 file:bg-gray-50 file:mr-4 file:py-2 file:px-4 hover:file:bg-gray-100 file:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500" />
          </div>

          <div class="mb-4">
            <label for="doc_complementares" class="block text-gray-700 mb-2">
              <i class="far fa-file-alt"></i> Documentos Complementares:
            </label>
            <input
              type="file"
              id="doc_complementares"
              name="doc_complementares[]"
              accept=".pdf"
              class="w-full text-gray-600 border rounded-md file:border-0 file:border-r border-gray-300 file:bg-gray-50 file:mr-4 file:py-2 file:px-4 hover:file:bg-gray-100 file:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"
              multiple />
          </div>

          <div class="flex justify-between mt-6">
            <button
              type="button"
              onclick="showSecondTab()"
              class="bg-gray-500 text-white px-6 py-2 rounded-md hover:bg-gray-600 transition-colors flex items-center">
              <i class="fas fa-arrow-left mr-2"></i>
              Voltar
            </button>
            <button
              type="submit"
              id="submitButton"
              onclick="handleFinalSubmission(event)"
              class="bg-green-500 text-white px-6 py-2 rounded-md hover:bg-green-600 transition-colors flex items-center">
              <span class="flex items-center">
                <i class="fas fa-check mr-2"></i>
                <span>Finalizar Solicitação</span>
              </span>
            </button>

            <button
              id="loadingButton"
              disabled
              type="button"
              class="hidden bg-green-500 text-white px-6 py-2 rounded-md flex items-center">
              <svg
                aria-hidden="true"
                role="status"
                class="inline w-4 h-4 me-3 text-white animate-spin"
                viewBox="0 0 100 101"
                fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
                  fill="#E5E7EB" />
                <path
                  d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
                  fill="currentColor" />
              </svg>
              Processando...
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Sucesso -->
    <div id="success-modal" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-screen max-h-full bg-gray-900/50 backdrop-blur-sm">
        <div class="relative p-4 w-full max-w-2xl max-h-full">
            <!-- Modal content -->
            <div class="relative bg-white rounded-xl shadow-2xl transform transition-all">
                <!-- Modal header -->
                <div class="flex items-center justify-between p-6 md:p-6 border-b rounded-t">
                    <div class="flex items-center gap-3">
                        <div class="bg-green-100 rounded-full p-2">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-900">
                            Solicitação Enviada com Sucesso!
                        </h3>
                    </div>
                    <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center transition-colors duration-200" data-modal-hide="success-modal">
                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                        </svg>
                        <span class="sr-only">Fechar modal</span>
                    </button>
                </div>
                <!-- Modal body -->
                <div class="p-6 md:p-6 space-y-4">
                    <div class="flex items-center gap-4 p-4 bg-green-50 rounded-lg">
                        <div class="flex-shrink-0">
                            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <p class="text-base leading-relaxed text-gray-600">
                            Sua solicitação foi enviada com sucesso! Nossa equipe analisará seu pedido e retornará em breve.
                        </p>
                    </div>
                    <div class="flex items-center gap-4 p-4 bg-blue-50 rounded-lg">
                        <div class="flex-shrink-0">
                            <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <p class="text-base leading-relaxed text-gray-600">
                            Um comprovante da sua solicitação será enviado para o email cadastrado (<span class="font-medium" id="emailConfirmation"></span>). Por favor, verifique também sua caixa de spam.
                        </p>
                    </div>
                </div>
                <!-- Modal footer -->
                <div class="flex flex-col-reverse sm:flex-row items-center justify-end gap-3 p-6 md:p-6 border-t border-gray-200 rounded-b">
                    <button onclick="window.location.href='../'" type="button" class="w-full sm:w-auto text-white bg-green-600 hover:bg-green-700 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-colors duration-200 flex items-center justify-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Voltar para Início
                    </button>
                    <button onclick="window.location.reload()" type="button" class="w-full sm:w-auto py-2.5 px-5 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-green-700 focus:z-10 focus:ring-4 focus:ring-gray-100 transition-colors duration-200 flex items-center justify-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        Nova Solicitação
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inclua o Bootstrap JS para modais (se necessário) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      // Add this function at the beginning of your script section
      function showCustomAlert(message) {
        // Create alert element
        const alertDiv = document.createElement("div");
        alertDiv.className =
          "fixed top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-50";
        alertDiv.role = "alert";

        // Add content
        alertDiv.innerHTML = `
          <span class="font-bold">Atenção!</span>
          <span class="block sm:inline"> ${message}</span>
          <span class="absolute top-0 bottom-0 right-0 px-4 py-3">
            <svg onclick="this.parentElement.parentElement.remove()" class="fill-current h-6 w-6 text-red-500" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
              <title>Fechar</title>
              <path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/>
            </svg>
          </span>
        `;

        // Add to document
        document.body.appendChild(alertDiv);

        // Remove after 5 seconds
        setTimeout(() => {
          alertDiv.remove();
        }, 5000);
      }

      // Script para alternar o menu mobile
      const menuBtn = document.getElementById("menu-btn");
      const mobileMenu = document.getElementById("mobile-menu");

      menuBtn.addEventListener("click", () => {
        mobileMenu.classList.toggle("hidden");
      });

      // Mostrar ou ocultar partes do formulário com base no tipo de solicitação
      document
        .getElementById("tipo_solicitacao")
        .addEventListener("change", handleSolicitacaoChange);

      function handleSolicitacaoChange() {
        const tipoSelecionado = this.value;
        const form = document.getElementById("DefesaForm");
        const camposApresentacao = document.getElementById(
          "campos_apresentacao"
        );

        // Campos que devem ser ocultados para Apresentação do Condutor
        const camposOcultar = [
          "cor",
          "especie",
          "categoria",
          "ano",
          "dataInfracao",
          "horaInfracao",
          "localInfracao",
          "enquadramento",
          "defesa",
        ];

        // Define o formulário correto baseado no tipo
        if (tipoSelecionado === "apresentacao_condutor") {
          form.action = "../utils/form/gerar_formulario_AP.php";
          // Mostra campos específicos de apresentação
          camposApresentacao.classList.remove("hidden");
          // Oculta campos não necessários
          camposOcultar.forEach((id) => {
            const elemento = document.getElementById(id)?.closest(".mb-4");
            if (elemento) elemento.style.display = "none";
          });
        } else {
          form.action = "../utils/form/gerar_formulario.php";
          // Oculta campos de apresentação
          camposApresentacao.classList.add("hidden");
          // Mostra todos os campos
          camposOcultar.forEach((id) => {
            const elemento = document.getElementById(id)?.closest(".mb-4");
            if (elemento) elemento.style.display = "block";
          });
        }
      }

      // Envio do formulário
      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("DefesaForm");
        form.addEventListener("submit", function (event) {
          event.preventDefault();
          showSecondTab();
        });
      });

      function showSecondTab() {
        // Valida o formulário primeiro
        if (!validateForm()) return;

        // Se passou na validação, salva os dados do formulário
        window.savedFormData = new FormData(
          document.getElementById("DefesaForm")
        );

        // Update stepper styles
        updateStepper(2);

        // Hide/show forms
        const form = document.getElementById("DefesaForm");
        const secondTab = document.getElementById("secondTab");
        const thirdTab = document.getElementById("thirdTab");
        form.classList.add("hidden");
        secondTab.classList.remove("hidden");
        thirdTab.classList.add("hidden");
      }

      function showThirdTab() {
        // Update stepper styles
        updateStepper(3);

        // Hide/show forms
        const form = document.getElementById("DefesaForm");
        const secondTab = document.getElementById("secondTab");
        const thirdTab = document.getElementById("thirdTab");
        form.classList.add("hidden");
        secondTab.classList.add("hidden");
        thirdTab.classList.remove("hidden");
      }

      function updateStepper(step) {
        // Atualizar classes do stepper baseado no passo atual
        for (let i = 1; i <= 3; i++) {
          const stepElement = document.getElementById(`step${i}`);
          const textElement = document.getElementById(`step${i}Text`);

          if (i <= step) {
            stepElement.querySelector("span").classList.add("bg-green-100");
            stepElement.querySelector("span").classList.remove("bg-gray-100");
            textElement.classList.add("text-green-600");
            textElement.classList.remove("text-gray-500");
          } else {
            stepElement.querySelector("span").classList.remove("bg-green-100");
            stepElement.querySelector("span").classList.add("bg-gray-100");
            textElement.classList.remove("text-green-600");
            textElement.classList.add("text-gray-500");
          }
        }
      }

      function showFirstTab() {
        // Recupera os dados salvos ao voltar para primeira aba
        if (window.savedFormData) {
          const form = document.getElementById("DefesaForm");
          window.savedFormData.forEach((value, key) => {
            const input = form.querySelector(`[name="${key}"]`);
            if (input) {
              if (input.type === "file") {
                // Não podemos restaurar arquivos por segurança
                // mas podemos manter uma referência
              } else {
                input.value = value;
              }
            }
          });
        }

        // Update stepper styles
        updateStepper(1);

        // Hide/show forms
        const form = document.getElementById("DefesaForm");
        const secondTab = document.getElementById("secondTab");
        const thirdTab = document.getElementById("thirdTab");
        form.classList.remove("hidden");
        secondTab.classList.add("hidden");
        thirdTab.classList.add("hidden");
      }

      function submitForm() {
    try {
        const form = document.getElementById("DefesaForm");
        const tipoSolicitacao = document.getElementById("tipo_solicitacao").value;

        if (!tipoSolicitacao) {
            showCustomAlert("Selecione um tipo de solicitação válido");
            return;
        }

        // Criar um novo formulário temporário
        const tempForm = document.createElement('form');
        tempForm.method = 'POST';
        tempForm.target = '_blank';
        tempForm.action = tipoSolicitacao === "apresentacao_condutor" 
            ? "../utils/form/gerar_formulario_AP.php"
            : "../utils/form/gerar_formulario.php";

        // Copiar todos os campos do formulário original
        const formData = new FormData(form);
        for (let [key, value] of formData.entries()) {
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = key;
            input.value = value;
            tempForm.appendChild(input);
        }

        // Adicionar timestamp para evitar cache
        const timestampInput = document.createElement('input');
        timestampInput.type = 'hidden';
        timestampInput.name = 'timestamp';
        timestampInput.value = new Date().getTime();
        tempForm.appendChild(timestampInput);

        // Adicionar o formulário ao documento, enviar e remover
        document.body.appendChild(tempForm);
        tempForm.submit();
        document.body.removeChild(tempForm);

    } catch (error) {
        console.error('Erro ao submeter formulário:', error);
        showCustomAlert("Erro ao gerar o documento. Por favor, tente novamente.");
    }
}

// Função auxiliar para verificar se a janela pop-up foi bloqueada
function checkPopupBlocked(popupWindow) {
    return new Promise((resolve) => {
        try {
            if (!popupWindow || popupWindow.closed || typeof popupWindow.closed == 'undefined') {
                showCustomAlert("Por favor, permita pop-ups para este site para gerar o documento.");
                resolve(true);
            } else {
                resolve(false);
            }
        } catch (e) {
            showCustomAlert("Por favor, permita pop-ups para este site para gerar o documento.");
            resolve(true);
        }
    });
}

      function handleFinalSubmission(event) {
        event.preventDefault();

        const submitButton = document.getElementById("submitButton");
        const loadingButton = document.getElementById("loadingButton");
        
        // Validar arquivos obrigatórios
        const requiredFiles = ['doc_requerimento', 'cnh'];
        const missingFiles = [];
        
        requiredFiles.forEach(fileId => {
            const fileInput = document.getElementById(fileId);
            if (!fileInput || !fileInput.files || !fileInput.files[0]) {
                missingFiles.push(fileId.replace('_', ' ').toUpperCase());
            }
        });
        
        if (missingFiles.length > 0) {
            showCustomAlert(`Por favor, envie os arquivos obrigatórios: ${missingFiles.join(', ')}`);
            return;
        }

        // Mostrar loading
        submitButton.classList.add("hidden");
        loadingButton.classList.remove("hidden");

        // Criar FormData com todos os campos
        const formData = new FormData(document.getElementById("DefesaForm"));

        // Adicionar todos os arquivos da terceira aba
        document.querySelectorAll('#thirdTab input[type="file"]').forEach(input => {
            if (input.files && input.files.length > 0) {
                if (input.multiple) {
                    // Para inputs que aceitam múltiplos arquivos
                    Array.from(input.files).forEach((file, index) => {
                        formData.append(`${input.name}`, file);
                    });
                } else {
                    formData.append(input.name, input.files[0]);
                }
            }
        });

        // Enviar requisição
        fetch("processa_formulario.php", {
            method: "POST",
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Mostrar o modal de sucesso
                const modal = document.getElementById("success-modal");
                modal.classList.remove("hidden");
                modal.classList.add("flex");

                // Adicionar o email ao texto de confirmação
                const emailConfirmation = document.getElementById("emailConfirmation");
                const emailInput = document.getElementById("gmail");
                if (emailConfirmation && emailInput) {
                    emailConfirmation.textContent = emailInput.value;
                }

                // Limpar o formulário
                document.getElementById("DefesaForm").reset();
                showFirstTab();
            } else {
                throw new Error(data.message || "Erro ao processar a solicitação");
            }
        })
        .catch(error => {
            console.error("Erro:", error);
            showCustomAlert(error.message || "Erro ao enviar a solicitação. Por favor, tente novamente.");
        })
        .finally(() => {
            submitButton.classList.remove("hidden");
            loadingButton.classList.add("hidden");
        });
    }

      function showAlert(message, classes) {
        const alertSpace = document.getElementById("alert-space");
        alertSpace.className = `block ${classes} my-4 p-4 rounded-md`;
        alertSpace.innerHTML = message; // Use innerHTML to allow HTML content
      }

      function updateFileName(input) {
        const fileName = input.files[0]?.name;
        const fileLabel = document.getElementById("fileLabel");
        const selectedFileName = document.getElementById("selectedFileName");

        if (fileName) {
          fileLabel.textContent = "Arquivo selecionado:";
          selectedFileName.textContent = fileName;
          selectedFileName.classList.remove("hidden");
        } else {
          fileLabel.textContent =
            "Clique para selecionar ou arraste o arquivo PDF";
          selectedFileName.classList.add("hidden");
        }
      }

      function updateFileNameGeneral(input) {
        const fileName = input.files[0]?.name;
        const parentLabel = input.closest("label");
        const fileNameSpan = parentLabel.querySelector(".file-name");
        const textSpan = parentLabel.querySelector(".text-gray-600");

        if (fileName) {
          textSpan.textContent = "Arquivo selecionado:";
          fileNameSpan.textContent = fileName;
          fileNameSpan.classList.remove("hidden");
        } else {
          textSpan.textContent =
            "Clique para selecionar ou arraste o arquivo PDF";
          fileNameSpan.classList.add("hidden");
        }
      }

      function validateForm() {
        const form = document.getElementById("DefesaForm");
        const tipoSolicitacao =
          document.getElementById("tipo_solicitacao").value;

        // Verifica se o tipo de solicitação foi selecionado
        if (!tipoSolicitacao) {
          showCustomAlert("Por favor, selecione o tipo de solicitação.");
          return false;
        }

        // Verifica se todos os campos obrigatórios estão preenchidos
        const requiredFields = form.querySelectorAll("[required]");
        let isValid = true;
        let firstInvalidField = null;

        requiredFields.forEach((field) => {
          if (!field.value) {
            isValid = false;
            if (!firstInvalidField) firstInvalidField = field;
            field.classList.add("border-red-500");
          } else {
            field.classList.remove("border-red-500");
          }
        });

        if (!isValid) {
          showCustomAlert("Por favor, preencha todos os campos obrigatórios.");
          firstInvalidField.focus();
          return false;
        }

        // Verifica se a declaração foi marcada
        const checkbox = document.getElementById("declaracao");
        if (!checkbox.checked) {
          showCustomAlert(
            "Você deve declarar que todas as informações fornecidas são verdadeiras."
          );
          return false;
        }

        // Validação dos emails
        const gmail = document.getElementById("gmail").value.trim();
        const confirmGmail = document
          .getElementById("confirm_gmail")
          .value.trim();

        if (gmail === "" || confirmGmail === "") {
          showCustomAlert("Por favor, preencha ambos os campos de email.");
          return false;
        }

        if (gmail !== confirmGmail) {
          showCustomAlert("Os emails informados não são iguais.");
          return false;
        }

        return true;
      }

      // Removemos a validação de validateAndProceed e apenas chamamos showSecondTab
      function validateAndProceed() {
        showSecondTab();
      }

      // Adicione esta função ao seu JavaScript existente
      document.getElementById("tipo_solicitacao").addEventListener("change", function() {
        const tipoSelecionado = this.value;
        const camposApresentacao = document.getElementById("campos_apresentacao");
        const camposDefesa = document.getElementById("campos_defesa");
        
        // Lista de campos para esconder/mostrar
        const camposEsconder = [
            "cor",
            "especie",
            "categoria",
            "ano",
            "dataInfracao",
            "horaInfracao",
            "localInfracao",
            "enquadramento",
            "defesa"
        ];
    
        // Mostrar/esconder campos baseado no tipo de solicitação
        if (tipoSelecionado === "apresentacao_condutor") {
            camposApresentacao.classList.remove("hidden"); // Mostra campos de apresentação
            if (camposDefesa) camposDefesa.classList.add("hidden");
            
            // Esconde os campos não necessários
            camposEsconder.forEach(id => {
                const elemento = document.getElementById(id)?.closest(".mb-4");
                if (elemento) elemento.style.display = "none";
            });
    
            // Certifica que o campo de registro CNH do infrator está visível
            const registroCNH = document.getElementById("registro_cnh_infrator")?.closest(".mb-4");
            if (registroCNH) registroCNH.style.display = "block";
            
        } else {
            camposApresentacao.classList.add("hidden"); // Esconde campos de apresentação
            if (camposDefesa) camposDefesa.classList.remove("hidden");
            
            // Mostra todos os campos
            camposEsconder.forEach(id => {
                const elemento = document.getElementById(id)?.closest(".mb-4");
                if (elemento) elemento.style.display = "block";
            });
        }
    });

    // Adicionar o event listener para fechar o modal
    document.querySelectorAll('[data-modal-hide="success-modal"]').forEach(button => {
        button.addEventListener('click', () => {
            const modal = document.getElementById("success-modal");
            modal.classList.add("hidden");
            modal.classList.remove("flex");
        });
    });

    // Adicione no início do seu script
    window.addEventListener('error', function(event) {
        // Ignora erros de extensões do Chrome/navegador
        if (event.filename && (
            event.filename.includes('chrome-extension') ||
            event.filename.includes('mozilla-extension') ||
            event.filename.includes('safari-extension') ||
            event.message.includes('permission error')
        )) {
            event.preventDefault();
            return;
        }
    });

    window.addEventListener('unhandledrejection', function(event) {
        // Ignora erros de extensões relacionados a permissão
        if (event.reason && (
            event.reason.name === 'n' ||
            (event.reason.message && event.reason.message.includes('permission error'))
        )) {
            event.preventDefault();
            return;
        }
    });

    // Definição dos campos obrigatórios
const camposComuns = [
    'nome', 'cpf', 'endereco', 'bairro', 'municipio', 
    'cep', 'telefone', 'gmail', 'placa', 'marcaModelo'
];

const camposEspecificos = {
    'defesa_previa': [
        'autoInfracao', 'dataInfracao', 'horaInfracao',
        'localInfracao', 'enquadramento', 'defesa'
    ],
    'apresentacao_condutor': [
        'cnh_numero', 'cnh_uf', 'registro_cnh_infrator'
    ],
    'jari': [
        'autoInfracao', 'defesa'
    ]
};

const documentosObrigatorios = {
    'defesa_previa': ['doc_requerimento', 'notif_DEMUTRAN', 'crlv'],
    'apresentacao_condutor': ['doc_requerimento', 'cnh_condutor', 'notif_DEMUTRAN'],
    'jari': ['doc_requerimento', 'cnh', 'crlv', 'notif_DEMUTRAN']
};

// Modificar o event listener existente do tipo_solicitacao
document.getElementById('tipo_solicitacao').addEventListener('change', function() {
    const tipoSelecionado = this.value;
    
    // Primeiro, remove required de todos os campos
    document.querySelectorAll('input, select, textarea').forEach(element => {
        element.removeAttribute('required');
    });

    // Adiciona required para campos comuns
    camposComuns.forEach(campo => {
        const elemento = document.getElementById(campo);
        if (elemento) elemento.setAttribute('required', '');
    });

    // Adiciona required para campos específicos do tipo selecionado
    if (tipoSelecionado && camposEspecificos[tipoSelecionado]) {
        camposEspecificos[tipoSelecionado].forEach(campo => {
            const elemento = document.getElementById(campo);
            if (elemento) elemento.setAttribute('required', '');
        });
    }

    // Adiciona required para documentos obrigatórios
    if (tipoSelecionado && documentosObrigatorios[tipoSelecionado]) {
        documentosObrigatorios[tipoSelecionado].forEach(doc => {
            const elemento = document.getElementById(doc);
            if (elemento) elemento.setAttribute('required', '');
        });
    }

    // Atualiza os indicadores visuais
    updateRequiredLabels();
});

// Adicione esta função para gerenciar os indicadores visuais de campos obrigatórios
function updateRequiredLabels() {
    // Primeiro, remove todos os indicadores
    document.querySelectorAll('label').forEach(label => {
        label.classList.remove('required-field');
    });

    const tipoSelecionado = document.getElementById('tipo_solicitacao').value;
    
    // Adiciona indicadores para campos comuns
    camposComuns.forEach(campo => {
        const label = document.querySelector(`label[for="${campo}"]`);
        if (label) label.classList.add('required-field');
    });

    // Adiciona indicadores para campos específicos do tipo selecionado
    if (tipoSelecionado && camposEspecificos[tipoSelecionado]) {
        camposEspecificos[tipoSelecionado].forEach(campo => {
            const label = document.querySelector(`label[for="${campo}"]`);
            if (label) label.classList.add('required-field');
        });
    }

    // Adiciona indicadores para documentos obrigatórios
    if (tipoSelecionado && documentosObrigatorios[tipoSelecionado]) {
        documentosObrigatorios[tipoSelecionado].forEach(doc => {
            const label = document.querySelector(`label[for="${doc}"]`);
            if (label) label.classList.add('required-field');
        });
    }
}

// Modifique o event listener do tipo_solicitacao
document.getElementById('tipo_solicitacao').addEventListener('change', function() {
    const tipoSelecionado = this.value;
    
    // Primeiro, remove required de todos os campos
    document.querySelectorAll('input, select, textarea').forEach(element => {
        element.removeAttribute('required');
    });

    // Adiciona required para campos comuns
    camposComuns.forEach(campo => {
        const elemento = document.getElementById(campo);
        if (elemento) elemento.setAttribute('required', '');
    });

    // Adiciona required para campos específicos do tipo selecionado
    if (tipoSelecionado && camposEspecificos[tipoSelecionado]) {
        camposEspecificos[tipoSelecionado].forEach(campo => {
            const elemento = document.getElementById(campo);
            if (elemento) elemento.setAttribute('required', '');
        });
    }

    // Adiciona required para documentos obrigatórios
    if (tipoSelecionado && documentosObrigatorios[tipoSelecionado]) {
        documentosObrigatorios[tipoSelecionado].forEach(doc => {
            const elemento = document.getElementById(doc);
            if (elemento) elemento.setAttribute('required', '');
        });
    }

    // Atualiza os indicadores visuais
    updateRequiredLabels();
});

// Chame a função no carregamento da página para marcar os campos iniciais
document.addEventListener('DOMContentLoaded', function() {
    updateRequiredLabels();
});

    </script>
  </body>
</html>
